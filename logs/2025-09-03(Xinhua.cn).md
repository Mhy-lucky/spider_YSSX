# 工作日志（新闻网站爬取项目）

## 项目注意点！！！！
** 不要一上来就盲目爬取整个网站，乱跑一通，要先仔细地坎网站的页面结构，然后不断在所有频道以及频道套频道的页面内找到所有有清晰文章列表的频道 URL，做好数据准备工作。**
** 然后从准备好的urls里面去逐页爬取所有新闻。**

## 具体实现
**项目目标**

* 自动爬取新华网英文频道各个板块的所有文章。
* 支持断点续爬，保证程序中断后可继续爬取未完成的频道。
* 点击每个频道列表中的“More”按钮，获取更多文章。
* 将爬取到的文章链接写入 TXT 文件，爬取失败的频道记录到另一个 TXT 文件。

---
### 1. 数据准备

* 已有频道列表：urls.txt。
* 输出文件：

  * `articles.txt`：存储所有爬取到的文章链接
  * `failed.txt`：存储爬取失败的频道 URL
  * `progress.txt`：记录断点续爬的进度，包含已完成和失败的频道列表

---

### 2. 技术选型

* 使用 **Python** + **Playwright 异步 API**。
* 浏览器采用 headless 模式，提高效率。
* 主要功能点：

  * 访问频道页面
  * 循环点击“More”按钮，获取所有文章链接
  * 去重写入文章 TXT 文件，保证不重复
  * 每点击一次“More”，只写入新增文章
  * 若点击“More”后没有新增文章，则跳到下一个频道
  * 出现异常时重试，重试失败记录到失败文件

---

### 3. 核心逻辑

* **读取频道列表**

  * JSON 或 TXT 格式均可兼容（最终采用 TXT）。
* **爬取文章链接**

  * 遍历每个频道 URL
  * 每次点击“More”按钮，抓取新增文章链接
  * 写入文件并刷新，保证“边爬边写”
  * 如果连续点击“More”没有新增文章，则停止当前频道爬取
* **断点续爬**

  * 使用 `progress.txt` 记录已完成和失败的频道
  * 程序重新运行时跳过已完成频道
* **异常处理**

  * 点击“More”失败时重试 3 次
  * URL 抓取异常时跳过
  * 整个频道失败记录到 `failed.txt`，可重新尝试

---

### 4. 调试与问题

* 初期问题：

  * “More”按钮选择器不准确，导致无法点击
  * 初始版本未实现“边爬边写”，文章链接延迟写入
  * JSON 频道列表导致解析报错
* 调整：

  * 精确定位“More”按钮：`#more.list-more`
  * 每次抓取文章后立即写入 TXT，保证断点续爬可实时保存
  * 支持 TXT 格式频道列表，每行一个 URL
  * 点击“More”后没有新文章就立即跳到下一个频道

---

### 5. 当前状态

* 可以顺利爬取频道列表中的所有文章链接
* 支持断点续爬和边爬边写入
* 点击“More”后只写入新增文章
* 爬取失败的频道记录清晰，可手动或自动重试


